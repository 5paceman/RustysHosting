<html>
    <head>
        <title>Rcon Test</title>
        <script>
            var websocket = null;

            function connect() {
                websocket = new WebSocket("ws://192.168.1.128:28016/Testpa55w0rd");
                websocket.onmessage = onMessage;
            }

            function onMessage(event) {
                var textbox = document.getElementById("console");
                console.log(event.data);
                var data = JSON.parse(event.data);
                textbox.value += data.Message;
            }

            function send()
            {
                var message = document.getElementById("command").value;
                document.getElementById("command").value = "";
                var packet = {
                    Identifier: 1,
                    Message: message,
                    Name: "WebRcon"
                };
                websocket.send(JSON.stringify(packet));
            }


            function checkConnection() {
                if(websocket != null)
                {
                    if(websocket.readyState  == WebSocket.OPEN)
                    {
                        document.getElementById("status").innerHTML = "Status: connected";
                    } else if(websocket.readyState == WebSocket.CLOSED) {
                        document.getElementById("status").innerHTML = "Status: disconnected";
                    } else if (websocket.readyState == WebSocket.CONNECTING) {
                        document.getElementById("status").innerHTML = "Status: connecting";
                    }
                }
            }

            setInterval(checkConnection, 3000);
        </script>
    </head>
    <body style="padding: 5;" onload="connect()">
        <label id="status">Status: disconnected</label>
        <textarea id="console" style="width: 100%; height: 600px;"></textarea>
        <input type="text" id="command" name="command" style="width: 40%;">
        <button type="button" id="send" value="Send" onclick="send()">Send</button>
    </body>
</html>